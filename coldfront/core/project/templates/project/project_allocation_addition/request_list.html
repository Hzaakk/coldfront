{% extends "common/base.html" %}
{% load crispy_forms_tags %}
{% load common_tags %}
{% load static %}


{% block title %}
Service Units Purchase {{ request_filter|title }} Requests %}
{% endblock %}


{% block content %}
<h1>{{ request_filter|title }} Service Units Purchase Requests</h1>
<hr>

<p>
  {% if request_filter == 'completed' %}
    View completed requests to purchase additional Service Units. You may also
    view pending requests
    <a href="{% url 'service-units-purchase-pending-request-list' %}">
      <span class="accessibility-link-text">Pending Requests</span>
      here</a>.
  {% else %}
    View pending requests to purchase additional Service Units. You may also
    view completed requests
    <a href="{% url 'service-units-purchase-completed-request-list' %}">
      <span class="accessibility-link-text">Completed Requests</span>
      here</a>.
  {% endif %}
</p>

<p>
  Note: Requests to purchase additional Service Units are limited to Recharge
  (ac_) projects on Savio.
</p>

{% if addition_request_list %}
<div class="table-responsive">
  <table class="table table-sm">
    <thead>
      <tr>
        <th scope="col">
          #
          <a href="?order_by=id&direction=asc&{{filter_parameters}}">
            <i class="fas fa-sort-up"></i>
          </a>
          <a href="?order_by=id&direction=des&{{filter_parameters}}">
            <i class="fas fa-sort-down"></i>
          </a>
        </th>
        <th scope="col">
          Date Requested/<br>Last Modified
          <a href="?order_by=modified&direction=asc&{{filter_parameters}}">
            <i class="fas fa-sort-up"></i>
          </a>
          <a href="?order_by=modified&direction=des&{{filter_parameters}}">
            <i class="fas fa-sort-down"></i>
          </a>
        </th>
        <th scope="col">
          Requester Email
          <a href="?order_by=requester__email&direction=asc&{{filter_parameters}}">
            <i class="fas fa-sort-up"></i>
          </a>
          <a href="?order_by=requester__email&direction=des&{{filter_parameters}}">
            <i class="fas fa-sort-down"></i>
          </a>
        </th>
        <th scope="col">
          Project
          <a href="?order_by=project&direction=asc&{{filter_parameters}}">
            <i class="fas fa-sort-up"></i>
          </a>
          <a href="?order_by=project&direction=des&{{filter_parameters}}">
            <i class="fas fa-sort-down"></i>
          </a>
        </th>
        <th scope="col">Number of Service Units</th>
        <th scope="col">Status</th>
      </tr>
    </thead>
    <tbody>
      {% for addition_request in addition_request_list %}
      <tr>
        <td>
          <a href="{% url 'service-units-purchase-request-detail' addition_request.pk %}">
            <span class="accessibility-link-text">
              Request {{ addition_request.pk }}
            </span>
            {{ addition_request.pk }}
          </a>
        </td>
        <td>{{ addition_request.modified|date:"M. d, Y" }}</td>
        <td>{{ addition_request.requester.email }}</td>
        <td>{{ addition_request.project.name }}</td>
        <td>{{ addition_request.num_service_units }}</td>
        <td>
          {% with status=addition_request.status.name %}
            {% if status == 'Under Review' %}
              <span class="badge badge-warning">{{ status }}</span>
            {% elif status == 'Complete' %}
              <span class="badge badge-success">{{ status }}</span>
            {% else %}
              <span class="badge badge-danger">{{ status }}</span>
            {% endif %}
          {% endwith %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="alert alert-info">
  No {{ request_filter }} purchase requests!
</div>
{% endif %}

<script>
  $("#navbar-main > ul > li.active").removeClass("active");
  $("#navbar-admin").addClass("active");
</script>

{% endblock %}

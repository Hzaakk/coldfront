<table class="table table-sm">
  <thead>
  <tr>
    <th scope="col">
      #
      <a href="?order_by=id&direction=asc&{{filter_parameters}}"><i class="fas fa-sort-up"></i></a>
      <a href="?order_by=id&direction=des&{{filter_parameters}}"><i class="fas fa-sort-down"></i></a>
    </th>
    <th scope="col">
      User
      <a href="?order_by=user__username&direction=asc&{{filter_parameters}}"><i class="fas fa-sort-up"></i></a>
      <a href="?order_by=user__username&direction=des&{{filter_parameters}}"><i class="fas fa-sort-down"></i></a>
    </th>
    <th scope="col">
      Date Requested
      <a href="?order_by=modified&direction=asc&{{filter_parameters}}"><i class="fas fa-sort-up"></i></a>
      <a href="?order_by=modified&direction=des&{{filter_parameters}}"><i class="fas fa-sort-down"></i></a>
    </th>
    <th scope="col">
      Status
    </th>
    <th scope="col">
      Reason(s)
    </th>
    <th scope="col">
      Clusters
    </th>
    {% if status == 'Queued' %}
      <th scope="col">
        Expiration
      </th>
    {% endif %}
    {% if user.is_superuser and actions_visible %}
      <th scope="col">
        Actions
      </th>
    {% endif %}
  </tr>
  </thead>
  <tbody>
  {% for request_tuple in queryset %}
    <tr>
      <td>{{ request_tuple.0.pk }}</td>
      <td><a href="{% url 'user-profile' request_tuple.0.user.username %}">{{ request_tuple.0.user.username }}</a></td>
      <td>{{ request_tuple.0.created|date:"M. d, Y" }}</td>
      {% with status=request_tuple.0.status.name %}
        <td>
          {% if status in "Queued,Ready,Processing" %}
            <span class="badge badge-warning">{{ status }}</span>
          {% elif "Complete" in status %}
            <span class="badge badge-success">{{ status }}</span>
          {% elif "Cancelled" in status %}
            <span class="badge badge-danger">{{ status }}</span>
          {% endif %}
        </td>
        <td>
          {% if 'NO_VALID_USER_ACCOUNT_FEE_BILLING_ID' in request_tuple.1 %}
              <span class="badge badge-primary">1</span>
          {% endif %}
          {% if 'NO_VALID_RECHARGE_USAGE_FEE_BILLING_ID' in request_tuple.1 %}
              <span class="badge badge-info">2</span>
          {% endif %}
        </td>
        <td>
          {{ request_tuple.2 }}
        </td>
        {% if status == 'Queued' %}
          <td>{{ request_tuple.0.expiration|date:"M. d, Y" }}</td>
        {% endif %}
        {% if user.is_superuser and actions_visible %}
          <td class="text-nowrap">
            <a href="{% url 'account-deactivation-request-cancel' request_tuple.0.pk %}" class="btn btn-danger mr-1">
              Cancel
            </a>
          </td>

        {% endif %}
      {% endwith %}

    </tr>
  {% endfor %}
  </tbody>
</table>
